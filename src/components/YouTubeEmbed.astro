---
interface Props { url: string }
const { url } = Astro.props;
const idFromUrl = (u: string) => {
  try {
    const x = new URL(u);
    if (x.hostname.includes('youtu.be')) return x.pathname.replace('/', '');
    if (x.searchParams.get('v')) return x.searchParams.get('v')!;
    if (x.pathname.startsWith('/shorts/')) return x.pathname.split('/')[2];
  } catch {}
  return '';
};
const id = idFromUrl(url);
---
{id && (
  <div class="yt">
    <iframe
      src={`https://www.youtube.com/embed/${id}`}
      title="YouTube video"
      allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
      allowfullscreen
      loading="lazy"
    />
  </div>
)}
<style>
  .yt { position:relative; padding-bottom:56.25%; height:0; overflow:hidden; border-radius:12px; box-shadow:var(--box-shadow); }
  .yt iframe { position:absolute; top:0; left:0; width:100%; height:100%; border:0; }
</style>

